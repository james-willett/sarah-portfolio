---
/**
 * ProjectCard - Portfolio project card component
 *
 * Displays a project thumbnail, title, description, and tags with hover effects.
 * Used on the homepage (featured projects) and portfolio grid page.
 *
 * @description A clean, minimal card design that matches Sarah's aesthetic from the reference
 * images. Features a subtle border, soft shadow on hover, and smooth transitions. The card
 * displays the full description text (no truncation) as per the technical spec, allowing
 * card heights to vary naturally based on content.
 *
 * @example
 * ```astro
 * <ProjectCard
 *   title="HiGloss Energy"
 *   description="Exploring emotion-based selection systems validated with users."
 *   href="/projects/higloss-energy"
 *   tags={['UX Design', 'Product Design']}
 *   featured={true}
 * />
 * ```
 *
 * @component ProjectCard
 * @prop {string} title - Project title displayed on the card
 * @prop {string} description - Full project description (shown without truncation)
 * @prop {ImageMetadata} [image] - Project thumbnail image (Astro Image component compatible)
 * @prop {string} [imageAlt] - Alt text for the image (defaults to title if not provided)
 * @prop {string} href - Link to the project detail page
 * @prop {string[]} [tags] - Array of project tags displayed as pills
 * @prop {boolean} [featured=false] - Whether this is a featured project (larger card variant)
 */

import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';

/**
 * Props interface for the ProjectCard component
 */
interface Props {
  /** Project title displayed prominently on the card */
  title: string;
  /** Full project description (displayed without truncation) */
  description: string;
  /** Project thumbnail image (Astro optimized image) */
  image?: ImageMetadata;
  /** Alt text for the image (defaults to title) */
  imageAlt?: string;
  /** URL path to the project detail page */
  href: string;
  /** Array of tag strings for categorization */
  tags?: string[];
  /** Whether this is a featured project (affects sizing) */
  featured?: boolean;
}

// Destructure props with sensible defaults
const {
  title,
  description,
  image,
  imageAlt = title,
  href,
  tags = [],
  featured = false,
} = Astro.props;
---

<article
  class:list={[
    // Base card styles - clean minimal design matching Sarah's aesthetic
    'group relative overflow-hidden rounded-xl',
    'bg-white dark:bg-zinc-900',
    'border border-border dark:border-border-dark',
    // Subtle shadow, increases on hover
    'shadow-sm hover:shadow-lg hover:shadow-black/5 dark:hover:shadow-black/20',
    // Smooth hover lift effect
    'transition-all duration-300 ease-out',
    'hover:-translate-y-1',
    // Featured variant gets a subtle accent ring
    featured && 'ring-1 ring-accent/10 dark:ring-accent-dark/10',
  ]}
>
  <a
    href={href}
    class="block focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent dark:focus-visible:ring-accent-dark focus-visible:ring-offset-2"
  >
    <!-- Project Image Container -->
    <div
      class:list={[
        'relative overflow-hidden',
        'bg-zinc-100 dark:bg-zinc-800',
        // Featured projects get a wider aspect ratio
        featured ? 'aspect-[16/10]' : 'aspect-[4/3]',
      ]}
    >
      {image ? (
        <!-- Optimized image using Astro's Image component -->
        <Image
          src={image}
          alt={imageAlt}
          class="w-full h-full object-cover transition-transform duration-500 ease-out group-hover:scale-105"
          loading="lazy"
          widths={featured ? [400, 800, 1200] : [400, 600, 800]}
          sizes={featured ? '(max-width: 768px) 100vw, 66vw' : '(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 33vw'}
        />
      ) : (
        <!-- Placeholder when no image is provided -->
        <div class="w-full h-full flex items-center justify-center">
          <svg
            class="w-12 h-12 text-zinc-300 dark:text-zinc-600"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            aria-hidden="true"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="1.5"
              d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
            />
          </svg>
        </div>
      )}

      <!-- Subtle overlay on hover -->
      <div
        class="absolute inset-0 bg-gradient-to-t from-black/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"
        aria-hidden="true"
      />
    </div>

    <!-- Project Content Section -->
    <div class="p-5 md:p-6 text-center">
      <!-- Title - changes color on hover -->
      <h3
        class:list={[
          'font-semibold text-foreground dark:text-foreground-dark',
          'group-hover:text-accent dark:group-hover:text-accent-dark transition-colors',
          featured ? 'text-xl mb-2' : 'text-lg mb-1.5',
        ]}
      >
        {title}
      </h3>

      <!-- Description - shown in full (no truncation per spec) -->
      <p
        class:list={[
          'text-muted dark:text-muted-dark leading-relaxed',
          featured ? 'text-base mb-4' : 'text-sm mb-3',
        ]}
      >
        {description}
      </p>

      <!-- Tags displayed as pill-shaped badges -->
      {tags.length > 0 && (
        <div class="flex flex-wrap gap-2">
          {tags.map((tag) => (
            <span
              class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium
                     bg-zinc-100 dark:bg-zinc-800
                     text-muted dark:text-muted-dark
                     border border-zinc-200 dark:border-zinc-700"
            >
              {tag}
            </span>
          ))}
        </div>
      )}
    </div>

    <!-- Visual arrow indicator (appears on hover) -->
    <div
      class="absolute bottom-5 right-5 md:bottom-6 md:right-6 w-8 h-8 flex items-center justify-center rounded-full bg-accent dark:bg-accent-dark text-background dark:text-background-dark opacity-0 group-hover:opacity-100 transform scale-90 group-hover:scale-100 transition-all duration-300"
      aria-hidden="true"
    >
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
    </div>
  </a>
</article>

<style>
  /* Respect reduced motion preferences */
  @media (prefers-reduced-motion: reduce) {
    article {
      transition: none;
    }
    article:hover {
      transform: none;
    }
    img, .absolute {
      transition: none;
    }
  }
</style>
